# ----------------------------------------------------------------------------------------------------------------------
# Playwright base service
# ----------------------------------------------------------------------------------------------------------------------

services:
    artemis-playwright:
        image: mcr.microsoft.com/playwright:v1.40.0-jammy
        pull_policy: if_not_present
        environment:
            baseUrl: "https://artemis-nginx"
            adminUsername: "${bamboo_artemis_admin_username}"
            adminPassword: "${bamboo_artemis_admin_password}"
#            username: "${bamboo_playwright_username_template}"
#            password: "${bamboo_playwright_password_template}"
            allowGroupCustomization: "true"
            studentGroupName: "artemis-e2etest-students"
            tutorGroupName: "artemis-e2etest-tutors"
            editorGroupName: "artemis-e2etest-editors"
            instructorGroupName: "artemis-e2etest-instructors"
#            createUsers: "${bamboo_playwright_create_users}"
        command: sh -c "cd /app/artemis/src/test/playwright && chmod 777 /root && npm ci && npm run playwright:test"
        volumes:
            - ..:/app/artemis
        networks:
            - artemis
        stdin_open: true
        tty: true
        ipc: host

networks:
    artemis:
        driver: "bridge"
        name: artemis
