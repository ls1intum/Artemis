name: Java Code Quality Analysis

on:
  push:
    branches: [ develop ]
    paths:
      - src/main/java/**
  pull_request:
    paths:
      -  src/main/java/**

jobs:
  code-quality-analysis:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v6
        with:
          fetch-depth: 0  # Fetch full history to enable git diff with base branch

      - name: Set up Python
        uses: actions/setup-python@v6
        with:
          python-version: '3.13'

      - name: Check LOC and number of class dependencies
        run: |
          # TODO these values should become zero in the future
          max_large_classes=10
          max_complex_beans=10

          python supporting_scripts/analyze_java_files.py \
            --max-large-classes $max_large_classes \
            --max-complex-beans $max_complex_beans \
            --event-type "${{ github.event_name }}" \
            --base-branch "${{ github.event.pull_request.base.ref || 'develop' }}"
