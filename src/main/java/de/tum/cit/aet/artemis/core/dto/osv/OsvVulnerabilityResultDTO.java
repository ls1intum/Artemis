package de.tum.cit.aet.artemis.core.dto.osv;

import java.util.List;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonInclude;

/**
 * DTO representing a single result entry in the OSV batch response.
 * Contains a list of vulnerabilities that affect the queried package/version.
 *
 * @param vulns the list of vulnerabilities affecting the package (empty if none found)
 */
@JsonInclude(JsonInclude.Include.NON_EMPTY)
@JsonIgnoreProperties(ignoreUnknown = true)
public record OsvVulnerabilityResultDTO(List<OsvVulnerabilityDTO> vulns) {

    /**
     * Checks if this result contains any vulnerabilities.
     *
     * @return true if vulnerabilities were found, false otherwise
     */
    public boolean hasVulnerabilities() {
        return vulns != null && !vulns.isEmpty();
    }
}
