package de.tum.cit.aet.artemis.core.dto;

import java.io.Serializable;
import java.util.List;

import com.fasterxml.jackson.annotation.JsonInclude;

/**
 * DTO representing a security vulnerability from OSV database.
 * Implements Serializable for distributed caching compatibility.
 *
 * @param id         the vulnerability ID (e.g., CVE-2024-1234, GHSA-xxxx-xxxx-xxxx)
 * @param summary    a brief summary of the vulnerability
 * @param details    detailed description of the vulnerability
 * @param severity   the severity level (CRITICAL, HIGH, MEDIUM, LOW, UNKNOWN)
 * @param cvssScore  the CVSS score if available (0.0-10.0)
 * @param aliases    alternative identifiers (e.g., CVE IDs)
 * @param fixedIn    versions where the vulnerability is fixed
 * @param references URLs with more information
 */
@JsonInclude(JsonInclude.Include.NON_EMPTY)
public record VulnerabilityDTO(String id, String summary, String details, String severity, Double cvssScore, List<String> aliases, List<String> fixedIn, List<String> references)
        implements Serializable {
}
