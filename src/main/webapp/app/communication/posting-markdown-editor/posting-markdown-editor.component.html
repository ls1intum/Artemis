<div class="col-12 position-relative">
    <jhi-markdown-editor-monaco
        class="markdown-editor background-editor-color w-100"
        [markdown]="content"
        (markdownChange)="updateField($event)"
        (onEditSelect)="previewMode = false"
        (onPreviewSelect)="previewMode = true"
        [metaActions]="[]"
        [headerActions]="undefined"
        [defaultActions]="defaultActions"
        [lectureReferenceAction]="lectureAttachmentReferenceAction"
        [enableFileUpload]="true"
        [useCommunicationForFileUpload]="true"
        [fallbackConversationId]="fallbackConversationId()"
        [colorAction]="undefined"
        [enableResize]="false"
        [showDefaultPreview]="false"
        [useDefaultMarkdownEditorOptions]="false"
        [linkEditorHeightToContentHeight]="true"
        [initialEditorHeight]="editorHeight"
        [resizableMinHeight]="editorHeight"
        [resizableMaxHeight]="MarkdownEditorHeight.MEDIUM"
        (keydown)="onKeyDown($event)"
        [isButtonLoading]="isButtonLoading()"
        [isFormGroupValid]="isFormGroupValid()"
        [editType]="editType()"
        [isInCommunication]="true"
        [course]="course()"
        [showCloseButton]="showCloseButton()"
        (closeEditor)="closeEditor.emit()"
    >
        <ng-container id="previewMonaco">
            @if (previewMode) {
                <jhi-posting-content [content]="content" />
            }
            <hr />
        </ng-container>
        <!-- End of Preview-->
    </jhi-markdown-editor-monaco>
    @if (showEmojiDropdown()) {
        <jhi-emoji-suggestion-dropdown
            #emojiDropdown
            [suggestions]="emojiSuggestions()"
            [dropdownStyle]="emojiDropdownStyle()"
            [activeIndex]="emojiActiveIndex()"
            (onSelect)="onEmojiSuggestionSelect($event)"
            (activeIndexChange)="emojiActiveIndex.set($event)"
        />
    }
</div>
@if (isInputLengthDisplayed || (content?.length ?? 0) > maxContentLength) {
    <div class="col mt-1 text-end">
        <p class="small my-0 ms-2" [ngStyle]="{ color: content?.length! > maxContentLength || content?.length! === 0 ? 'red' : 'inherit' }">
            {{ content?.length ?? 0 }} / {{ maxContentLength }}
        </p>
    </div>
}
