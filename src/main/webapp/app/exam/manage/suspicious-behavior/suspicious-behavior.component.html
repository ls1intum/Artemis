<h5>{{ 'artemisApp.examManagement.suspiciousBehavior.title' | artemisTranslate }}</h5>

<p>
    {{ 'artemisApp.examManagement.suspiciousBehavior.suspiciousSessionDescription' | artemisTranslate }}
</p>

<div>
    <input
        class="form-check-input"
        type="checkbox"
        id="different-student-exams-same-ip"
        [(ngModel)]="checkboxCriterionDifferentStudentExamsSameIPAddressChecked"
        (change)="updateAnalyzeButtonState()"
    />
    <label for="different-student-exams-same-ip">{{ 'artemisApp.examManagement.suspiciousBehavior.suspiciousSessionCriterionIpAddress' | artemisTranslate }}</label>
</div>

<div>
    <input
        class="form-check-input"
        type="checkbox"
        id="different-student-exams-same-browser"
        [(ngModel)]="checkboxCriterionDifferentStudentExamsSameBrowserFingerprintChecked"
        (change)="updateAnalyzeButtonState()"
    />
    <label for="different-student-exams-same-browser">{{ 'artemisApp.examManagement.suspiciousBehavior.suspiciousSessionCriterionBrowserFingerprint' | artemisTranslate }}</label>
</div>

<div>
    <input
        class="form-check-input"
        type="checkbox"
        id="same-student-exam-different-ips"
        [(ngModel)]="checkboxCriterionSameStudentExamDifferentIPAddressesChecked"
        (change)="updateAnalyzeButtonState()"
    />
    <label for="same-student-exam-different-ips">{{ 'artemisApp.examManagement.suspiciousBehavior.suspiciousSessionCriterionDifferentIpAddress' | artemisTranslate }}</label>
</div>

<div>
    <input
        class="form-check-input"
        type="checkbox"
        id="same-student-exam-different-browser"
        [(ngModel)]="checkboxCriterionSameStudentExamDifferentBrowserFingerprintsChecked"
        (change)="updateAnalyzeButtonState()"
    />
    <label for="same-student-exam-different-browser">{{
        'artemisApp.examManagement.suspiciousBehavior.suspiciousSessionCriterionDifferentBrowserFingerprint' | artemisTranslate
    }}</label>
</div>

<div>
    <input
        class="form-check-input"
        type="checkbox"
        id="ip-outside-of-range"
        [(ngModel)]="checkboxCriterionIPOutsideOfASpecificRangeChecked"
        (change)="updateAnalyzeButtonState()"
    />
    <label for="ip-outside-of-range">{{ 'artemisApp.examManagement.suspiciousBehavior.suspiciousSessionCriterionIpOutsideOfRange' | artemisTranslate }}</label>
</div>
<div *ngIf="checkboxCriterionIPOutsideOfASpecificRangeChecked" class="form-group">
    <label for="ip-subnet">{{ 'artemisApp.examManagement.suspiciousBehavior.upperBoundIp' | artemisTranslate }}</label>
    <input type="text" class="form-control" id="ip-subnet" [(ngModel)]="ipSubnet" (change)="updateAnalyzeButtonState()" />
</div>

<div class="mt-3 mb-3">
    <jhi-button [title]="'artemisApp.examManagement.suspiciousBehavior.analyzeSessions'" [disabled]="!analyzeButtonEnabled" [isLoading]="analyzing" (onClick)="analyzeSessions()">
    </jhi-button>
</div>
<div class="column">
    <p *ngIf="suspiciousSessions?.length! >= 0">This exam has {{ suspiciousSessions?.length }} cases</p>
    <button *ngIf="suspiciousSessions.length !== 0" type="submit" (click)="goToSuspiciousSessions()" class="btn btn-primary mb-5">
        <span class="d-none d-md-inline" id="view-sessions-btn" jhiTranslate="artemisApp.examManagement.suspiciousBehavior.suspiciousSessions.view">View</span>
    </button>
</div>
<jhi-plagiarism-cases-overview
    [exercises]="exercises"
    [plagiarismCasesPerExercise]="plagiarismCasesPerExercise"
    [plagiarismResultsPerExercise]="plagiarismResultsPerExercise"
    [anyPlagiarismCases]="anyPlagiarismCases"
    [courseId]="courseId"
    [examId]="examId"
>
</jhi-plagiarism-cases-overview>
