<ng-container>
    @if (participations?.length && participations?.length === 1) {
        <button
            jhi-exercise-action-button
            [id]="'open-exercise-' + exercise.id!"
            [buttonIcon]="faFolderOpen"
            class="open-code-editor"
            [jhiFeatureToggle]="FeatureToggle.ProgrammingExercises"
            [buttonLabel]="'artemisApp.exerciseActions.openCodeEditor' | artemisTranslate"
            [buttonLoading]="loading"
            [smallButton]="smallButtons"
            [hideLabelMobile]="false"
            [routerLink]="[courseAndExerciseNavigationUrl, participations[0].id]"
        ></button>
    }
    @if (participations?.length && participations.length! > 1) {
        <button
            jhi-exercise-action-button
            [buttonIcon]="faFolderOpen"
            class="open-code-editor"
            [jhiFeatureToggle]="FeatureToggle.ProgrammingExercises"
            [buttonLabel]="'artemisApp.exerciseActions.openCodeEditor' | artemisTranslate"
            [buttonLoading]="loading"
            [smallButton]="smallButtons"
            [hideLabelMobile]="false"
            [ngbPopover]="popContent"
            [autoClose]="'outside'"
            placement="right auto"
        ></button>
    }
    @if (exercise.allowFeedbackRequests) {
        @if (athenaEnabled) {
            <a
                class="btn btn-primary"
                (click)="requestFeedback()"
                [class.btn-sm]="smallButtons"
                [id]="'request-feedback-' + exercise.id"
                [ngbTooltip]="'artemisApp.exerciseActions.requestAutomaticFeedbackTooltip' | artemisTranslate"
            >
                <fa-icon [icon]="faPenSquare" [fixedWidth]="true" />
                <span class="d-none d-md-inline" jhiTranslate="artemisApp.exerciseActions.requestAutomaticFeedback">Send automatic feedback request</span>
            </a>
        } @else {
            <a
                class="btn btn-primary"
                (click)="requestFeedback()"
                [class.btn-sm]="smallButtons"
                [id]="'request-feedback-' + exercise.id"
                [ngbTooltip]="'artemisApp.exerciseActions.requestManualFeedbackTooltip' | artemisTranslate"
            >
                <fa-icon [icon]="faPenSquare" [fixedWidth]="true" />
                <span class="d-none d-md-inline" jhiTranslate="artemisApp.exerciseActions.requestManualFeedback">Send manual feedback request</span>
            </a>
        }
    }
    <ng-template #popContent style="max-width: 660px">
        @if (participations && participations.length > 1) {
            <div class="form-check form-switch">
                <input id="switchPracticeMode" mdbCheckbox class="form-check-input" type="checkbox" [checked]="isPracticeMode" (click)="switchPracticeMode()" />
                <label for="switchPracticeMode" class="form-check-label">
                    {{ 'artemisApp.exerciseActions.practiceMode.title' | artemisTranslate }}
                </label>
            </div>
        }
        <button
            jhi-exercise-action-button
            [id]="'open-exercise-popover-' + exercise.id!"
            [buttonIcon]="faFolderOpen"
            class="open-code-editor"
            [jhiFeatureToggle]="FeatureToggle.ProgrammingExercises"
            [buttonLabel]="'artemisApp.exerciseActions.' + (isPracticeMode ? 'openPracticeCodeEditor' : 'openGradedCodeEditor') | artemisTranslate"
            [buttonLoading]="loading"
            [smallButton]="smallButtons"
            [hideLabelMobile]="false"
            [routerLink]="[courseAndExerciseNavigationUrl, activeParticipation.id]"
        ></button>
    </ng-template>
</ng-container>
