<div class="inline-refinement-container" [style.top.px]="top()" [style.left.px]="left()">
    @if (!isExpanded()) {
        <!-- Collapsed: Trigger button with text label -->
        <button
            type="button"
            class="refinement-trigger-btn"
            (click)="expand()"
            [attr.aria-label]="'artemisApp.programmingExercise.problemStatement.inlineRefinement.triggerButton' | artemisTranslate"
        >
            <fa-icon [icon]="facArtemisIntelligence" />
            <span class="trigger-label">{{ 'artemisApp.programmingExercise.problemStatement.inlineRefinement.triggerButton' | artemisTranslate }}</span>
        </button>
    } @else {
        <!-- Expanded: Input field with submit -->
        <div class="refinement-input-container">
            <input
                #instructionInput
                type="text"
                class="refinement-input"
                [placeholder]="'artemisApp.programmingExercise.problemStatement.inlineRefinement.placeholder' | artemisTranslate"
                [(ngModel)]="instruction"
                (keydown)="onKeydown($event)"
                [disabled]="isSubmitting()"
            />
            <button
                type="button"
                class="refinement-submit-btn"
                (click)="submit()"
                [disabled]="!instruction || isSubmitting()"
                [attr.title]="'artemisApp.programmingExercise.problemStatement.inlineRefinement.submitTooltip' | artemisTranslate"
            >
                <fa-icon [icon]="faPaperPlane" />
            </button>
            <button type="button" class="refinement-close-btn" (click)="handleClose()">
                <fa-icon [icon]="faTimes" />
            </button>
        </div>
    }
</div>
