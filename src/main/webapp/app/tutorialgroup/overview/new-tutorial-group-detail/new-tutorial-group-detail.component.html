<div class="frame">
    <h2 id="page-title">{{ tutorialGroup().title }}</h2>
    <hr />
    <div class="card-row">
        <div class="card small">
            <h5 jhiTranslate="artemisApp.pages.tutorialGroupDetail.cardTitles.tutorCardTitle"></h5>
            <div class="tutor-card-content">
                <jhi-profile-picture
                    imageSizeInRem="6"
                    fontSizeInRem="2"
                    imageId="tutor-profile-picture"
                    defaultPictureId="tutor-default-profile-picture"
                    [authorName]="tutorialGroup().teachingAssistantName"
                    [imageUrl]="teachingAssistantImageUrl()"
                />
                {{ tutorialGroup().teachingAssistantName }}
            </div>
        </div>
        <div class="card big">
            <h5 jhiTranslate="artemisApp.pages.tutorialGroupDetail.cardTitles.generalInfoCardTitle"></h5>
            <div class="info-card-content">
                <div class="info-stack">
                    <div class="info-item">
                        <fa-icon [icon]="faFlag" />
                        <span class="info-label">{{ ('artemisApp.pages.tutorialGroupDetail.language' | artemisTranslate) + ':' }}</span>
                        {{ tutorialGroupLanguage() }}
                    </div>
                    <div class="info-item">
                        <fa-icon [icon]="faUsers" />
                        <span class="info-label">{{ ('artemisApp.pages.tutorialGroupDetail.capacity' | artemisTranslate) + ':' }}</span>
                        {{ tutorialGroupCapacity() }}
                    </div>
                </div>
                <div class="info-stack">
                    <div class="info-item">
                        <fa-icon [icon]="faTag" />
                        <span class="info-label">{{ ('artemisApp.pages.tutorialGroupDetail.mode' | artemisTranslate) + ':' }}</span>
                        <span jhiTranslate="{{ tutorialGroupMode() }}"></span>
                    </div>
                    <div class="info-item">
                        <fa-icon [icon]="faBuildingColumns" />
                        <span class="info-label">{{ ('artemisApp.pages.tutorialGroupDetail.campus' | artemisTranslate) + ':' }}</span>
                        {{ tutorialGroupCampus() }}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-row">
        <div class="card small">
            <h5 jhiTranslate="artemisApp.pages.tutorialGroupDetail.cardTitles.averageAttendanceCardTitle"></h5>
            <div class="attendance-card-content position-relative">
                <div class="doughnut-chart-text">{{ averageAttendancePercentage() }}</div>
                <ngx-charts-pie-chart
                    [view]="[128, 128]"
                    [results]="pieChartData()"
                    [scheme]="pieChartColors()"
                    [doughnut]="true"
                    [labels]="false"
                    [legend]="false"
                    [arcWidth]="0.3"
                />
            </div>
        </div>
        <div class="card big">
            <h5 jhiTranslate="artemisApp.pages.tutorialGroupDetail.cardTitles.nextSessionCardTitle"></h5>
            <div class="info-card-content">
                @let nextSession = nextSessionData();
                @if (nextSession) {
                    <div class="info-stack">
                        <div class="info-item">
                            <fa-icon [icon]="faCalendar" />
                            <span class="info-label">{{ ('artemisApp.pages.tutorialGroupDetail.date' | artemisTranslate) + ':' }}</span>
                            <span [ngClass]="{ 'strikethrough-text': nextSession.isCancelled }">{{ nextSession.date }}</span>
                            @if (nextSession.dateChanged) {
                                <div class="change-indicator"></div>
                            }
                        </div>
                        <div class="info-item">
                            <fa-icon [icon]="faClock" />
                            <span class="info-label">{{ ('artemisApp.pages.tutorialGroupDetail.time' | artemisTranslate) + ':' }}</span>
                            <span [ngClass]="{ 'strikethrough-text': nextSession.isCancelled }">{{ nextSession.time }}</span>
                            @if (nextSession.timeChanged) {
                                <div class="change-indicator"></div>
                            }
                        </div>
                    </div>
                    <div class="info-stack">
                        <div class="info-item">
                            <fa-icon [icon]="faCircleExclamation" />
                            <span class="info-label"> {{ ('artemisApp.pages.tutorialGroupDetail.status' | artemisTranslate) + ':' }}</span>
                            <jhi-tutorial-group-detail-session-status-indicator
                                [isCancelled]="nextSession.isCancelled"
                                [locationChanged]="nextSession.locationChanged"
                                [timeChanged]="nextSession.timeChanged"
                                [dateChanged]="nextSession.dateChanged"
                            />
                        </div>
                        <div class="info-item">
                            <fa-icon [icon]="faMapPin" />
                            <span class="info-label">{{ ('artemisApp.pages.tutorialGroupDetail.location' | artemisTranslate) + ':' }}</span>
                            <span [ngClass]="{ 'strikethrough-text': nextSession.isCancelled }">{{ nextSession.location }}</span>
                            @if (nextSession.locationChanged) {
                                <div class="change-indicator"></div>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
    <div class="list-controls-row">
        <h3>Sessions</h3>
        <p-selectbutton [options]="listOptions" [ngModel]="selectedListOption()" (ngModelChange)="selectedListOption.set($event)" optionLabel="label" optionValue="value" />
    </div>

    @let sessions = tutorialGroupSessions();
    @if (sessions) {
        <p-table [value]="sessions" stripedRows>
            <ng-template #header>
                <tr>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Location</th>
                    <th>Attendance</th>
                    <th>Status</th>
                </tr>
            </ng-template>
            <ng-template #body let-session>
                <tr class="table-row">
                    <td>
                        <div class="changeable-session-property" [ngClass]="{ 'strikethrough-text': session.isCancelled }">
                            {{ session.date }}
                            @if (session.dateChanged) {
                                <div class="change-indicator"></div>
                            }
                        </div>
                    </td>
                    <td>
                        <div class="changeable-session-property" [ngClass]="{ 'strikethrough-text': session.isCancelled }">
                            {{ session.time }}
                            @if (session.timeChanged) {
                                <div class="change-indicator"></div>
                            }
                        </div>
                    </td>
                    <td>
                        <div class="changeable-session-property" [ngClass]="{ 'strikethrough-text': session.isCancelled }">
                            {{ session.location }}
                            @if (session.locationChanged) {
                                <div class="change-indicator"></div>
                            }
                        </div>
                    </td>
                    <td>{{ session.attendance }}</td>
                    <td>
                        <jhi-tutorial-group-detail-session-status-indicator
                            [isCancelled]="session.isCancelled"
                            [locationChanged]="session.locationChanged"
                            [timeChanged]="session.timeChanged"
                            [dateChanged]="session.dateChanged"
                        />
                    </td>
                </tr>
            </ng-template>
        </p-table>
    }
</div>
