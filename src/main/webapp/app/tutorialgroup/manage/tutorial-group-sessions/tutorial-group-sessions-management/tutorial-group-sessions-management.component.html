<p-dialog
    [header]="('artemisApp.pages.tutorialGroupSessionManagement.title' | artemisTranslate) + (tutorialGroup ? ' - ' + tutorialGroup.title : '')"
    [modal]="true"
    [visible]="dialogVisible()"
    [closable]="true"
    (visibleChange)="dialogVisible.set($event)"
    (onHide)="close()"
    [style]="{ width: '60rem' }"
    appendTo="body"
    styleClass="session-management-dialog"
>
    <jhi-loading-indicator-container [isLoading]="isLoading">
        @if (tutorialGroup) {
            <div class="row tutorial-group-session-management">
                @if (tutorialGroup.tutorialGroupSchedule) {
                    <div class="col-12">
                        <!-- Schedule -->
                        <dt>
                            <span jhiTranslate="artemisApp.entities.tutorialGroup.schedule"></span>
                        </dt>
                        <dd>
                            @if (tutorialGroup.tutorialGroupSchedule) {
                                <span>{{
                                    (getDayTranslationKey(tutorialGroup.tutorialGroupSchedule?.dayOfWeek) | artemisTranslate) +
                                        ' ' +
                                        (tutorialGroup.tutorialGroupSchedule?.startTime | removeSeconds) +
                                        '-' +
                                        (tutorialGroup.tutorialGroupSchedule?.endTime | removeSeconds)
                                }}</span>
                                <br />
                                @if (tutorialGroup.isOnline) {
                                    <span jhiTranslate="artemisApp.forms.scheduleForm.locationInput.labelOnline"></span>
                                }
                                @if (!tutorialGroup.isOnline) {
                                    <span jhiTranslate="artemisApp.forms.scheduleForm.locationInput.labelOffline"></span>
                                }
                                : {{ tutorialGroup.tutorialGroupSchedule?.location }}
                                <br />
                                <span>
                                    {{
                                        (tutorialGroup.tutorialGroupSchedule!.repetitionFrequency! === 1
                                            ? 'artemisApp.entities.tutorialGroupSchedule.repetitionOneWeek'
                                            : 'artemisApp.entities.tutorialGroupSchedule.repetitionNWeeks'
                                        ) | artemisTranslate: { n: tutorialGroup.tutorialGroupSchedule!.repetitionFrequency! }
                                    }}
                                </span>
                            } @else {
                                <span jhiTranslate="artemisApp.pages.tutorialGroupDetail.scheduleNotSet"></span>
                            }
                            <br />
                        </dd>
                    </div>
                }
                <div class="my-2">
                    <button type="button" id="create-session-button" class="btn btn-primary" (click)="openCreateSessionDialog($event)">
                        <fa-icon [icon]="faPlus" />
                        <span jhiTranslate="artemisApp.pages.tutorialGroupSessionManagement.createSessionButton"></span>
                    </button>
                </div>
                <div class="scrollbar table-wrapper-scroll-y border border-lightgrey p-3">
                    <jhi-tutorial-group-sessions-table
                        [sessions]="sessions"
                        [timeZone]="course().timeZone"
                        [showIdColumn]="true"
                        [tutorialGroup]="tutorialGroup"
                        (attendanceUpdated)="attendanceUpdated = true"
                    >
                        <ng-template let-session>
                            <jhi-tutorial-group-session-row-buttons
                                [tutorialGroupSession]="session()"
                                [course]="course()"
                                [tutorialGroup]="tutorialGroup"
                                (cancelOrActivatePressed)="loadAll()"
                                (tutorialGroupSessionDeleted)="loadAll()"
                                (tutorialGroupEdited)="loadAll()"
                            />
                        </ng-template>
                    </jhi-tutorial-group-sessions-table>
                </div>
            </div>
        }
    </jhi-loading-indicator-container>
</p-dialog>

<jhi-create-tutorial-group-session #createSessionDialog [course]="course()" [tutorialGroup]="tutorialGroup" (sessionCreated)="onSessionCreated()" />
