<div class="mt-3 row m-0 align-items-center justify-content-between">
    <h5 class="m-0 col-md-auto p-0" [jhiTranslate]="'artemisApp.' + courseCompetencyType() + '.title'"></h5>
    <div class="col-md-auto p-0 d-flex">
        <div ngbDropdown class="ms-3">
            <button id="importCompetenciesDropdown" class="btn btn-sm btn-secondary" ngbDropdownToggle>
                <fa-icon [icon]="faFileImport" />
                <span [jhiTranslate]="'artemisApp.' + courseCompetencyType() + '.manage.importButton'"></span>
            </button>
            <div ngbDropdownMenu aria-labelledby="importCompetenciesDropdown">
                <button class="btn" id="importAllCompetenciesButton" (click)="openImportAllModal(courseCompetencyType().toString())" ngbDropdownItem>
                    <fa-icon [icon]="faFileImport" />
                    <span [jhiTranslate]="'artemisApp.' + courseCompetencyType() + '.manage.importAllButton'"></span>
                </button>
                <a class="btn" [routerLink]="['/course-management', courseId(), courseCompetencyType() + '-management', 'import']" ngbDropdownItem>
                    <fa-icon [icon]="faFileImport" />
                    <span [jhiTranslate]="'artemisApp.' + courseCompetencyType() + '.manage.importFromCoursesButton'"></span>
                </a>
                @if (standardizedCompetenciesEnabled()) {
                    <a class="btn" [routerLink]="['/course-management', courseId(), courseCompetencyType() + '-management', 'import-standardized']" ngbDropdownItem>
                        <fa-icon [icon]="faFileImport" />
                        <span [jhiTranslate]="'artemisApp.' + courseCompetencyType() + '.manage.importStandardizedButton'"></span>
                    </a>
                }
            </div>
        </div>
        <a class="ms-3 btn btn-sm btn-secondary" [routerLink]="['/course-management', courseId(), courseCompetencyType() + '-management', 'create']">
            <fa-icon [icon]="faPlus" />
            <span [jhiTranslate]="'artemisApp.' + courseCompetencyType() + '.manage.createButton'"></span>
        </a>
    </div>
</div>
<hr class="my-2" />
<div class="course-competency-table-container">
    <table class="table table-striped">
        <thead>
            <tr>
                <th class="col-md-auto">#</th>
                <th class="col">
                    <span jhiTranslate="artemisApp.competency.title"></span>
                </th>
                <th class="col-4">
                    <span jhiTranslate="artemisApp.competency.description"></span>
                </th>
                <th class="col">
                    <span jhiTranslate="artemisApp.competency.softDueDate"></span>
                </th>
                <th class="col">
                    <span jhiTranslate="artemisApp.competency.masteredStudents"></span>
                </th>
                <th class="col-1">
                    <span jhiTranslate="artemisApp.competency.optional"></span>
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @for (courseCompetency of courseCompetencies(); track courseCompetency.id) {
                <tr>
                    <td class="col-md-auto">{{ courseCompetency.id }}</td>
                    <td class="col">
                        <div class="d-flex align-items-center">
                            @let taxonomy = courseCompetency.taxonomy ?? 'none';
                            <fa-icon [icon]="getIcon(courseCompetency.taxonomy)" [ngbTooltip]="'artemisApp.courseCompetency.taxonomies.' + taxonomy | artemisTranslate" />
                            <a class="ms-2" [routerLink]="['/courses', courseId(), 'competencies', courseCompetency.id]">
                                {{ courseCompetency.title }}
                            </a>
                        </div>
                    </td>
                    <td class="col markdown-preview" [innerHTML]="courseCompetency.description | htmlForMarkdown"></td>
                    <td class="col">{{ courseCompetency.softDueDate | artemisDate }}</td>
                    <td class="col" [ngbTooltip]="courseCompetency.numberOfMasteredStudents + '/' + courseCompetency.numberOfStudents">
                        {{ courseCompetency.numberOfStudents == 0 ? 0 : ((courseCompetency.numberOfMasteredStudents / courseCompetency.numberOfStudents) * 100 | number: '1.0-0') }}
                        %
                    </td>
                    <td class="col-1">
                        <span [jhiTranslate]="'global.generic.' + (courseCompetency.optional ? 'yes' : 'no')"></span>
                    </td>
                    <td>
                        <div class="d-flex justify-content-end">
                            <a
                                [routerLink]="['/course-management', courseId(), courseCompetencyType() + '-management', courseCompetency.id, 'edit']"
                                class="btn btn-sm btn-outline-secondary"
                            >
                                <fa-icon [icon]="faEdit" />
                                <span jhiTranslate="entity.action.edit"></span>
                            </a>
                            <button
                                jhiDeleteButton
                                [entityTitle]="courseCompetency.title"
                                [deleteQuestion]="'artemisApp.' + courseCompetencyType() + '.competencyCard.delete.question'"
                                [deleteConfirmationText]="'artemisApp.' + courseCompetencyType() + '.competencyCard.delete.typeNameToConfirm'"
                                (delete)="deleteCourseCompetency(courseCompetency.id!)"
                                [dialogError]="dialogError"
                                class="ms-3 btn btn-sm"
                            >
                                <fa-icon [icon]="faTrash" />
                            </button>
                        </div>
                    </td>
                </tr>
            } @empty {
                <tr>
                    <td colspan="7">
                        <div class="text-center text-secondary">
                            <small
                                ><em><span [jhiTranslate]="'artemisApp.' + courseCompetencyType() + '.manage.empty'"></span></em
                            ></small>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
