<jhi-lecture-unit-card
    [courseId]="courseId()"
    [lectureUnit]="lectureUnit()"
    [icon]="getAttachmentIcon()"
    [showViewIsolatedButton]="hasAttachment()"
    [showOriginalVersionButton]="!!lectureUnit().attachment?.studentVersion"
    [viewIsolatedButtonLabel]="'artemisApp.attachmentVideoUnit.download'"
    [viewIsolatedButtonIcon]="faDownload"
    [isPresentationMode]="isPresentationMode()"
    (onCompletion)="toggleCompletion($event)"
    (onCollapse)="toggleCollapse($event)"
    (onShowIsolated)="handleDownload()"
    (onShowOriginalVersion)="handleOriginalVersion()"
>
    <!-- Video units don't need to show file details since the video is already playing -->

    @if (lectureUnit()?.description) {
        <div>
            <hr />
            {{ lectureUnit().description }}
        </div>
    }

    @if (!!lectureUnit().attachment && !!videoUrl()) {
        <hr />
    }

    @if (!!videoUrl()) {
        @if (playlistUrl() && hasTranscript()) {
            <!-- Use playlist URL with transcript (for TUM Live videos) -->
            <jhi-video-player [videoUrl]="playlistUrl()!" [transcriptSegments]="transcriptSegments()" />
        } @else if (isM3u8Video()) {
            <!-- Use video player for M3U8 videos (including local video storage) -->
            <jhi-video-player [videoUrl]="videoUrl()!" [transcriptSegments]="transcriptSegments()" />
        } @else {
            <!-- Fallback for other video types -->
            <div class="video-player-container">
                <div class="ratio ratio-16x9">
                    <iframe id="videoFrame" class="rounded" [src]="videoUrl() | safeResourceUrl" allow="fullscreen"></iframe>
                </div>
            </div>
        }
    }
</jhi-lecture-unit-card>
