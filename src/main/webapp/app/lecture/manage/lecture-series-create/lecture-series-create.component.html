<div class="frame">
    <p jhiTranslate="artemisApp.lecture.createSeries.explanationText"></p>
    <div class="from-section">
        <p-floatlabel variant="on">
            <p-datepicker
                inputId="start-date"
                [ngModel]="seriesStartDate() ?? null"
                (ngModelChange)="seriesStartDate.set($event)"
                style="width: 12rem"
                [firstDayOfWeek]="1"
                [minDate]="minimumStartDate"
            />
            <label for="start-date" jhiTranslate="artemisApp.lecture.createSeries.inputLabel.seriesStartDate"></label>
        </p-floatlabel>
        <p-floatlabel variant="on">
            <p-datepicker
                inputId="end-date"
                [ngModel]="seriesEndDate() ?? null"
                (ngModelChange)="seriesEndDate.set($event)"
                style="width: 12rem"
                [firstDayOfWeek]="1"
                [minDate]="minimumSeriesEndDate()"
                [invalid]="isSeriesEndDateInvalid()"
            />
            <label for="end-date" jhiTranslate="artemisApp.lecture.createSeries.inputLabel.seriesEndDate"></label>
        </p-floatlabel>
    </div>
    <p>Specify at least one weekly lecture by choosing a weekday, as well as a start time and end time:</p>
    @for (weeklyLecture of weeklyLectures(); track weeklyLecture.id) {
        <div class="from-section">
            <p-floatlabel variant="on">
                <p-select
                    inputId="weekday"
                    [options]="weekdayOptions()"
                    [ngModel]="weeklyLecture.selectedWeekdayIndex()"
                    (ngModelChange)="weeklyLecture.selectedWeekdayIndex.set($event)"
                    optionLabel="label"
                    optionValue="weekdayIndex"
                    style="width: 12rem"
                />
                <label for="weekday" jhiTranslate="artemisApp.lecture.createSeries.inputLabel.weekday"></label>
            </p-floatlabel>
            <p-floatlabel variant="on">
                <p-inputMask
                    inputId="start-time"
                    mask="99 : 99"
                    slotChar="-"
                    [ngModel]="weeklyLecture.startTimeString() ?? ''"
                    (ngModelChange)="weeklyLecture.startTimeString.set($event)"
                    [invalid]="weeklyLecture.isStartAndEndTimeCombinationInvalid()"
                    [style]="{ width: '12rem' }"
                />
                <label for="start-time" jhiTranslate="artemisApp.lecture.createSeries.inputLabel.startTime"></label>
            </p-floatlabel>
            <p-floatlabel variant="on">
                <p-inputMask
                    inputId="end-time"
                    mask="99 : 99"
                    slotChar="-"
                    [ngModel]="weeklyLecture.endTimeString() ?? ''"
                    (ngModelChange)="weeklyLecture.endTimeString.set($event)"
                    [invalid]="weeklyLecture.isStartAndEndTimeCombinationInvalid()"
                    [style]="{ width: '12rem' }"
                />
                <label for="end-time" jhiTranslate="artemisApp.lecture.createSeries.inputLabel.endTime"></label>
            </p-floatlabel>
            @if (weeklyLectures().length !== 1) {
                <button pButton outlined severity="secondary" size="small" class="weekly-lecture-delete-button" (click)="removeWeeklyLecture(weeklyLecture)">
                    <fa-icon [icon]="faTrash" />
                </button>
            }
        </div>
    }
    <button pButton severity="secondary" size="small" [style]="{ width: '12rem' }" (click)="addWeeklyLecture()">Add Weekly Lecture</button>
    @let drafts = lectureDrafts();
    @if (drafts.length > 0) {
        <h3 jhiTranslate="artemisApp.lecture.createSeries.generatedLecturesHeading"></h3>
        <div class="container w-100 px-0">
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
                @for (draft of lectureDrafts(); track draft.id; let index = $index) {
                    <div class="col">
                        <div class="draft-card">
                            <span class="card-number" [ngClass]="{ edited: draft.state === LectureDraftState.EDITED }">
                                {{ index + 1 }}
                            </span>
                            <span class="draft-title">{{ draft.dto.title }}</span>
                            <button type="button" class="card-button" (click)="editModal.open(draft)">
                                <fa-icon [icon]="faPenToSquare" />
                            </button>
                            <button type="button" class="card-button" (click)="deleteLectureDraft(draft)">
                                <fa-icon [icon]="faXmark" />
                            </button>
                        </div>
                    </div>
                }
            </div>
        </div>
    }
    <div class="controls-section">
        <button pButton severity="secondary" size="small" (click)="cancel()" jhiTranslate="entity.action.cancel"></button>
        <button pButton size="small" [disabled]="noDraftsGenerated()" (click)="save()" jhiTranslate="entity.action.save"></button>
    </div>
    @if (isLoading()) {
        <div class="loading-overlay">
            <div class="spinner-border" role="status">
                <span class="visually-hidden" jhiTranslate="loading"></span>
            </div>
        </div>
    }
</div>

<jhi-lecture-series-edit-modal #editModal />
