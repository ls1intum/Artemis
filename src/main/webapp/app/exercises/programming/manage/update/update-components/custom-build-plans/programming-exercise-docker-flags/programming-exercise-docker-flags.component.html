<div class="form-check">
    <label class="form-check-label" for="field_editDockerFlags">
        <input class="form-check-input" type="checkbox" name="editDockerFlags" id="field_editDockerFlags" (click)="onDisplayEditDockerFlags()"/>
        <span jhiTranslate="artemisApp.programmingExercise.dockerFlags.title"></span>
        <jhi-help-icon text="artemisApp.programmingExercise.dockerFlags.description" />
    </label>
</div>

@if (displayEditDockerFlags) {
    <ngx-datatable
        id="editDockerFlagsTable"
        class="bootstrap"
        trackByProp="id"
        [headerHeight]="50"
        [limit]="10"
        [columnMode]="'force'"
        [rowHeight]="'auto'"
        [rows]="dockerFlags"
    >
        <ngx-datatable-column [name]="'Flag'" [minWidth]='200' [maxWidth]='300'>
            <ng-template ngx-datatable-cell-template let-row="row" let-rowIndex="rowIndex">
                <div class="d-flex align-items-center gap-2">
                    <select class="form-select" [ngModel]="row[0]" (change)="updateFlagKey($event, rowIndex)">
                        <option value="" disabled selected>
                            <span jhiTranslate="artemisApp.programmingExercise.dockerFlags.selectFlag"></span>
                        </option>
                        @for (flag of allowedDockerFlagOptions; track flag) {
                            <option [value]="flag">{{ flag }}</option>
                        }
                    </select>
                    <jhi-help-icon [text]="'artemisApp.programmingExercise.dockerFlags.' + (row[0] || 'default')"/>
                </div>
            </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column [name]="'Value'">
            <ng-template ngx-datatable-cell-template let-row="row" let-rowIndex="rowIndex">
                <jhi-table-editable-field
                    [value]="row[1]"
                    [onValueUpdate]="updateFlagValue(rowIndex)"
                />
            </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column [maxWidth]='150'>
            <ng-template ngx-datatable-cell-template let-row="row" let-rowIndex="rowIndex">
                <button class="btn btn-sm btn-danger" (click)="removeDockerFlag(rowIndex)">
                    <fa-icon [icon]="faTrash"></fa-icon>
                    <span jhiTranslate="artemisApp.programmingExercise.dockerFlags.removeFlag"></span>
                </button>
            </ng-template>
        </ngx-datatable-column>
    </ngx-datatable>
    <button class="btn btn-sm btn-primary mb-2" (click)="addDockerFlag()">
        <fa-icon [icon]="faPlus"></fa-icon>
        <span jhiTranslate="artemisApp.programmingExercise.dockerFlags.addFlag"></span>
    </button>

    @if (!isValid) {
        <div class="alert alert-danger" role="alert">
            <span jhiTranslate="artemisApp.programmingExercise.dockerFlags.error"></span>
        </div>
    }
}
