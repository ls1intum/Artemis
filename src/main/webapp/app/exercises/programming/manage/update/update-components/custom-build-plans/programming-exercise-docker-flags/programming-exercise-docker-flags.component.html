<div class="form-check">
    <label class="form-check-label" for="field_editDockerFlags">
        <input class="form-check-input" type="checkbox" name="editDockerFlags" id="field_editDockerFlags" (click)="onDisplayEditDockerFlags()" />
        <span jhiTranslate="Enable Custom Docker Flags"></span>
        <jhi-help-icon text="Allows defining custom resource constraints (RAM, CPU, etc.) for this programming exercise." />
    </label>
</div>

@if (displayEditDockerFlags) {
    <ngx-datatable id="editDockerFlagsTable" class="bootstrap" trackByProp="id" [headerHeight]="50" [limit]="10" [columnMode]="'force'" [rowHeight]="'auto'" [rows]="dockerFlags">
        <ngx-datatable-column [name]="'Flag'" [minWidth]="200" [maxWidth]="300">
            <ng-template ngx-datatable-cell-template let-row="row" let-rowIndex="rowIndex">
                <div class="d-flex align-items-center gap-2">
                    <select class="form-select" [ngModel]="row[0]" (change)="updateFlagKey($event, rowIndex)">
                        <option value="" disabled selected>
                            <span jhiTranslate="Select a flag"></span>
                        </option>
                        @for (flag of allowedDockerFlagOptions; track flag) {
                            <option [value]="flag">{{ flag }}</option>
                        }
                    </select>
                    <jhi-help-icon [text]="' ' + (row[0] || 'default')" />
                </div>
            </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column [name]="'Value'">
            <ng-template ngx-datatable-cell-template let-row="row" let-rowIndex="rowIndex">
                <select class="form-select" [ngModel]="row[1]" (change)="updateFlagValue($event, rowIndex)">
                    <option value="" disabled selected>
                        <span jhiTranslate="Select a value"></span>
                    </option>
                    @for (value of getAllowedValues(row[0]); track value) {
                        <option [value]="value">{{ value }}</option>
                    }
                </select>
            </ng-template>
        </ngx-datatable-column>

        <ngx-datatable-column [maxWidth]="150">
            <ng-template ngx-datatable-cell-template let-row="row" let-rowIndex="rowIndex">
                <button class="btn btn-sm btn-danger" (click)="removeDockerFlag(rowIndex)">
                    <fa-icon [icon]="faTrash" />
                    <span jhiTranslate="Remove"></span>
                </button>
            </ng-template>
        </ngx-datatable-column>
    </ngx-datatable>

    <button class="btn btn-sm btn-primary mb-2" (click)="addDockerFlag()">
        <fa-icon [icon]="faPlus" />
        <span jhiTranslate="Add Docker Flag"></span>
    </button>

    @if (!isValid) {
        <div class="alert alert-danger" role="alert">
            <span jhiTranslate="Invalid flag configuration."></span>
        </div>
    }
}
