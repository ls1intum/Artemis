<div class="frame">
    @if (variant() === CalendarEventFilterComponentVariant.DESKTOP) {
        <div class="chips-section">
            @for (optionAndMetadata of includedOptionsAndMetadata(); track optionAndMetadata.option) {
                @let option = optionAndMetadata.option;
                @let nameKey = optionAndMetadata.nameKey;
                @let colorClassName = optionAndMetadata.colorClassName;
                <div class="chip" [attr.data-testid]="'chip-' + option">
                    <div class="legend-circle" [class]="colorClassName"></div>
                    <span jhiTranslate="{{ nameKey }}"></span>
                    <fa-icon [icon]="faXmark" class="remove-button" (click)="toggleOption(option)" />
                </div>
            }
        </div>
    }
    <button
        type="button"
        [ngClass]="{
            btn: variant() === CalendarEventFilterComponentVariant.DESKTOP,
            'btn-outline-primary': variant() === CalendarEventFilterComponentVariant.DESKTOP,
            'filter-button': variant() === CalendarEventFilterComponentVariant.MOBILE,
        }"
        container="body"
        [ngbPopover]="popoverContent"
        popoverClass="filter-popover"
        [autoClose]="'outside'"
        triggers="click"
        placement="bottom-end"
    >
        @if (variant() === CalendarEventFilterComponentVariant.DESKTOP) {
            <span jhiTranslate="artemisApp.calendar.filterButtonLabel"></span>
            <fa-icon [icon]="faChevronDown" />
        }
        @if (variant() === CalendarEventFilterComponentVariant.MOBILE) {
            <fa-icon class="filter-icon" [icon]="faFilter" />
        }
    </button>
</div>

<ng-template #popoverContent>
    <div class="dropdown">
        @for (optionAndMetadata of optionsAndMetadata(); track optionAndMetadata.option) {
            @let option = optionAndMetadata.option;
            @let nameKey = optionAndMetadata.nameKey;
            @let isIncluded = optionAndMetadata.isIncluded;
            <div class="form-check dropdown-item">
                <input class="form-check-input" type="checkbox" id="filter-{{ option }}" [checked]="isIncluded" (change)="toggleOption(option)" />
                <label class="form-check-label" for="filter-{{ option }}" jhiTranslate="{{ nameKey }}"></label>
            </div>
        }
    </div>
</ng-template>
