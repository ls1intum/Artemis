<div class="frame">
    @for (week of weeks(); track week.id) {
        <div class="week-row">
            @for (day of week.days; track day.id) {
                @if (day.isInDisplayedMonth) {
                    <div class="day" (click)="selectDate.emit(day.date)">
                        <jhi-calendar-day-badge [day]="day.date" />
                        <div class="event-stack">
                            @if (day.events.length > 3) {
                                @for (event of day.firstTwoEvents; track event.id) {
                                    <ng-container *ngTemplateOutlet="eventCell; context: { $implicit: event }" />
                                }
                                <div class="ellipsis">
                                    <span class="dot"></span>
                                    <span class="dot"></span>
                                    <span class="dot"></span>
                                </div>
                            } @else {
                                @for (event of day.events; track event.id) {
                                    <ng-container *ngTemplateOutlet="eventCell; context: { $implicit: event }" />
                                }
                            }
                        </div>
                    </div>
                } @else {
                    <div class="day-placeholder"></div>
                }
            }
        </div>
    }
</div>

<ng-template #eventCell let-event>
    <div
        class="event-cell"
        [ngClass]="{
            'exam-event-cell': event.isOfType(CalendarEventType.Exam),
            'lecture-event-cell': event.isOfType(CalendarEventType.Lecture),
            'tutorial-event-cell': event.isOfType(CalendarEventType.Tutorial),
            'exercise-event-cell': event.isOfExerciseType(),
        }"
    ></div>
</ng-template>
