<div>
    <jhi-button
        id="reload"
        [btnType]="isDirty ? WARNING : PRIMARY"
        [isLoading]="isLoading"
        [icon]="faRotate"
        [title]="'artemisApp.iris.settings.button.reload'"
        (onClick)="loadIrisSettings()"
    />
    <jhi-button id="save" [btnType]="SUCCESS" [isLoading]="isSaving" [icon]="faSave" [title]="'artemisApp.iris.settings.button.save'" (onClick)="saveIrisSettings()" />
</div>
@if (irisSettings) {
    <div>
        @if (settingsType === GLOBAL) {
            <div>
                <h3 jhiTranslate="artemisApp.iris.settings.autoUpdate.title"></h3>
                <jhi-iris-global-autoupdate-settings-update [irisSettings]="irisSettings" (onChanges)="isDirty = true" />
            </div>
        }
        <h3 jhiTranslate="artemisApp.iris.settings.subSettings.chatSettings"></h3>
        <div>
            <jhi-iris-common-sub-settings-update
                [subSettings]="irisSettings?.irisChatSettings"
                [parentSubSettings]="parentIrisSettings?.irisChatSettings"
                [allIrisModels]="allIrisModels ?? []"
                [settingsType]="settingsType"
                (onChanges)="isDirty = true"
            />
        </div>
        @if (settingsType !== EXERCISE) {
            <div>
                <hr class="hr" />
                <h3 jhiTranslate="artemisApp.iris.settings.subSettings.lectureIngestionSettings.title"></h3>
                <jhi-iris-common-sub-settings-update
                    [subSettings]="irisSettings?.irisLectureIngestionSettings!"
                    [parentSubSettings]="parentIrisSettings?.irisLectureIngestionSettings"
                    [allIrisModels]="allIrisModels ?? []"
                    [settingsType]="settingsType"
                    (onChanges)="isDirty = true"
                />
            </div>
        }
        @if (settingsType === COURSE) {
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="autoLectureIngestion" [disabled]="!isAdmin" [(ngModel)]="autoLectureIngestion" />
                <label
                    class="form-check-label"
                    for="autoLectureIngestion"
                    jhiTranslate="artemisApp.iris.settings.subSettings.lectureIngestionSettings.autoIngestOnAttachmentUpload"
                ></label>
            </div>
        }
        @if (settingsType !== EXERCISE) {
            <div>
                <hr class="hr" />
                <h3 jhiTranslate="artemisApp.iris.settings.subSettings.hestiaSettings"></h3>
                <jhi-iris-common-sub-settings-update
                    [subSettings]="irisSettings?.irisHestiaSettings!"
                    [parentSubSettings]="parentIrisSettings?.irisHestiaSettings"
                    [allIrisModels]="allIrisModels ?? []"
                    [settingsType]="settingsType"
                    (onChanges)="isDirty = true"
                />
            </div>
        }
        @if (settingsType !== EXERCISE) {
            <div>
                <hr class="hr" />
                <h3 jhiTranslate="artemisApp.iris.settings.subSettings.competencyGenerationSettings"></h3>
                <jhi-iris-common-sub-settings-update
                    [subSettings]="irisSettings?.irisCompetencyGenerationSettings!"
                    [parentSubSettings]="parentIrisSettings?.irisCompetencyGenerationSettings"
                    [allIrisModels]="allIrisModels ?? []"
                    [settingsType]="settingsType"
                    (onChanges)="isDirty = true"
                />
            </div>
        }
        @if (settingsType !== EXERCISE) {
            <div>
                <hr class="hr" />
                <h3 jhiTranslate="artemisApp.iris.settings.subSettings.proactivitySettings.title"></h3>
                <jhi-iris-common-sub-settings-update
                    [subSettings]="irisSettings?.irisProactivitySettings!"
                    [parentSubSettings]="parentIrisSettings?.irisProactivitySettings"
                    [allIrisModels]="allIrisModels ?? []"
                    [settingsType]="settingsType"
                    (onChanges)="isDirty = true"
                />
            </div>
            @if (irisSettings.irisProactivitySettings?.eventSettings) {
                <div>
                    <h4 jhiTranslate="artemisApp.iris.settings.subSettings.proactivitySettings.eventSettings.title"></h4>
                </div>
                <br />
                @for (eventSettings of irisSettings.irisProactivitySettings!.eventSettings; track eventSettings.id) {
                    @switch (eventSettings.type) {
                        @case (IrisEventType.SUBMISSION_FAILED) {
                            <div>
                                <h5 jhiTranslate="artemisApp.iris.settings.subSettings.proactivitySettings.eventSettings.submissionSuccessful"></h5>
                            </div>
                        }
                        @case (IrisEventType.SUBMISSION_SUCCESSFUL) {
                            <div>
                                <h5 jhiTranslate="artemisApp.iris.settings.subSettings.proactivitySettings.eventSettings.submissionFailed"></h5>
                            </div>
                        }
                        @case (IrisEventType.JOL) {
                            <div>
                                <h5 jhiTranslate="artemisApp.iris.settings.subSettings.proactivitySettings.eventSettings.jol"></h5>
                            </div>
                        }
                    }
                    <div>
                        <jhi-iris-event-settings-update
                            [eventSettings]="eventSettings"
                            [parentEventSettings]="parentIrisEventSettings ? parentIrisEventSettings[eventSettings.type] : undefined"
                            [settingsType]="settingsType"
                            (eventSettingsChange)="eventSettingsChanged($event)"
                            [proactivityDisabled]="!irisSettings.irisProactivitySettings!.enabled"
                        />
                    </div>
                    <br />
                }
            }
        }
    </div>
}
