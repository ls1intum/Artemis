<ng-template #scoringExplanation let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h5 class="modal-title">
            <span jhiTranslate="artemisApp.quizExercise.explanationText.scoringTitle" [translateValues]="{ paramTitle: question().title, paramIndex: questionIndex() }"></span>
        </h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="d()"></button>
    </div>
    @if (question().scoringType === ScoringType.ALL_OR_NOTHING && isSingleChoice) {
        <div class="modal-body">
            <span class="font-weight-bold" jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeSingleChoice"></span>
            <span jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeSingleChoiceExplanation"></span>
            <br />
            <div>
                @if (correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) {
                    <span>
                        <span
                            jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceSingleChoiceCorrect"
                            [translateValues]="{
                                paramScore: score(),
                                paramQuestionScore: question().points,
                                paramPoint: scorePoint,
                                paramScorePoint: questionPoint,
                            }"
                        ></span
                    ></span>
                }
                @if (!(correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0)) {
                    <span>
                        <span
                            jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceSingleChoiceNotCorrect"
                            [translateValues]="{
                                paramScore: score(),
                                paramQuestionScore: question().points,
                                paramPoint: scorePoint,
                                paramScorePoint: questionPoint,
                            }"
                        ></span
                    ></span>
                }
            </div>
        </div>
    }
    @if (question().scoringType === ScoringType.ALL_OR_NOTHING && !isSingleChoice) {
        <div class="modal-body">
            <span class="font-weight-bold" jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeAllOrNothing"></span>
            <span jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeAllOrNothingExplanation"></span>
            <br />
            @if (question().type === QuizQuestionType.MULTIPLE_CHOICE) {
                <div>
                    @if (correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (!(correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0)) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceAllOrNothingNotCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramInTotalWrongOptions: inTotalSelectedWrongOptions,
                                    paramInTotalRightOptions: inTotalSelectedRightOptions,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    wrongOption: wrongOption,
                                    rightOption: rightOption,
                                }"
                            ></span
                        ></span>
                    }
                </div>
            }
            @if (question().type === QuizQuestionType.DRAG_AND_DROP) {
                <div>
                    @if (incorrectlyMappedDragAndDropItems() === 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (incorrectlyMappedDragAndDropItems() !== 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropAllOrNothingNotCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramWrongMappedItems: incorrectlyMappedDragAndDropItems(),
                                    paramRightMapping: correctlyMappedDragAndDropItems(),
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightMap: rightMap,
                                    wrongMap: wrongMap,
                                }"
                            ></span
                        ></span>
                    }
                </div>
            }
            @if (question().type === QuizQuestionType.SHORT_ANSWER) {
                <div>
                    @if (!(shortAnswerWrongAnswers > 0)) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (shortAnswerWrongAnswers > 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerAllOrNothingNotCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramShortAnswerWrongOption: shortAnswerWrongAnswers,
                                    paramShortAnswerCorrectAnswers: shortAnswerCorrectAnswers,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightGap: rightGap,
                                    wrongGap: wrongGap,
                                }"
                            ></span
                        ></span>
                    }
                </div>
            }
        </div>
    }
    @if (question().scoringType === ScoringType.PROPORTIONAL_WITH_PENALTY) {
        <div class="modal-body">
            <span class="font-weight-bold" jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeProportional"></span>
            <span jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeProportionalExplanation"></span>
            <br />
            @if (question().type === QuizQuestionType.MULTIPLE_CHOICE) {
                <div>
                    @if (correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (!(correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) && differenceMultipleChoice >= 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramAmountOfAnswerOptions: multipleChoiceAnswerOptions,
                                    paramInTotalWrongOptions: inTotalSelectedWrongOptions,
                                    paramInTotalRightOptions: inTotalSelectedRightOptions,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    wrongOption: wrongOption,
                                    rightOption: rightOption,
                                }"
                            ></p>
                            <b
                                >+ {{ inTotalSelectedRightOptions }}*{{ question().points }} /{{ multipleChoiceAnswerOptions }} - {{ inTotalSelectedWrongOptions }}*{{
                                    question().points
                                }}/{{ multipleChoiceAnswerOptions }} = {{ score() }}</b
                            >
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                    @if (!(correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) && differenceMultipleChoice < 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramAmountOfAnswerOptions: multipleChoiceAnswerOptions,
                                    paramInTotalWrongOptions: inTotalSelectedWrongOptions,
                                    paramInTotalRightOptions: inTotalSelectedRightOptions,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    wrongOption: wrongOption,
                                    rightOption: rightOption,
                                }"
                            ></p>
                            <b
                                >+ {{ inTotalSelectedRightOptions }}*{{ question().points }} /{{ multipleChoiceAnswerOptions }} - {{ inTotalSelectedWrongOptions }}*{{
                                    question().points
                                }}/{{ multipleChoiceAnswerOptions }}
                                = 0
                            </b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.zeroPointer"></p>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                </div>
            }
            @if (question().type === QuizQuestionType.DRAG_AND_DROP) {
                <div>
                    @if (incorrectlyMappedDragAndDropItems() === 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (incorrectlyMappedDragAndDropItems() !== 0 && differenceDragAndDrop >= 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramWrongMappedItems: incorrectlyMappedDragAndDropItems(),
                                    paramRightMapping: correctlyMappedDragAndDropItems(),
                                    paramDragAndDropElementsCount: mappedLocations(),
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightMap: rightMap,
                                    wrongMap: wrongMap,
                                }"
                            ></p>
                            <b
                                >+ {{ correctlyMappedDragAndDropItems() }}*{{ question().points }}/{{ mappedLocations() }} - {{ incorrectlyMappedDragAndDropItems() }}*{{
                                    question().points
                                }}/{{ mappedLocations() }} = {{ score() }}</b
                            >
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                    @if (incorrectlyMappedDragAndDropItems() !== 0 && differenceDragAndDrop < 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramWrongMappedItems: incorrectlyMappedDragAndDropItems(),
                                    paramRightMapping: correctlyMappedDragAndDropItems(),
                                    paramDragAndDropElementsCount: mappedLocations(),
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightMap: rightMap,
                                    wrongMap: wrongMap,
                                }"
                            ></p>
                            <b
                                >+ {{ correctlyMappedDragAndDropItems() }}*{{ question().points }}/{{ mappedLocations() }} - {{ incorrectlyMappedDragAndDropItems() }}*{{
                                    question().points
                                }}/{{ mappedLocations() }}
                                = 0
                            </b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.zeroPointer"></p>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                </div>
            }
            @if (question().type === QuizQuestionType.SHORT_ANSWER) {
                <div>
                    @if (shortAnswerWrongAnswers <= 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (shortAnswerWrongAnswers > 0 && differenceShortAnswer >= 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramShortAnswerWrongOption: shortAnswerWrongAnswers,
                                    paramShortAnswerCorrectAnswers: shortAnswerCorrectAnswers,
                                    paramCount: shortAnswerSpots,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightGap: rightGap,
                                    wrongGap: wrongGap,
                                }"
                            ></p>
                            <b
                                >+ {{ shortAnswerCorrectAnswers }}*{{ question().points }}/{{ shortAnswerSpots }} - {{ shortAnswerWrongAnswers }}*{{ question().points }}/{{
                                    shortAnswerSpots
                                }}
                                = {{ score() }}</b
                            >
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                    @if (shortAnswerWrongAnswers > 0 && differenceShortAnswer < 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramShortAnswerWrongOption: shortAnswerWrongAnswers,
                                    paramShortAnswerCorrectAnswers: shortAnswerCorrectAnswers,
                                    paramCount: shortAnswerSpots,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightGap: rightGap,
                                    wrongGap: wrongGap,
                                }"
                            ></p>
                            <b
                                >+ {{ shortAnswerCorrectAnswers }}*{{ question().points }}/{{ shortAnswerSpots }} - {{ shortAnswerWrongAnswers }}*{{ question().points }}/{{
                                    shortAnswerSpots
                                }}
                                = 0
                            </b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.zeroPointer"></p>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                </div>
            }
        </div>
    }
    @if (question().scoringType === ScoringType.PROPORTIONAL_WITHOUT_PENALTY) {
        <div class="modal-body">
            <span class="font-weight-bold" jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeProportionalWithout"></span>
            <span jhiTranslate="artemisApp.quizExercise.explanationText.scoringTypeProportionalWithoutExplanation"></span>
            <br />
            @if (question().type === QuizQuestionType.MULTIPLE_CHOICE) {
                <div>
                    @if (correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (!(correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) && differenceMultipleChoice >= 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramAmountOfAnswerOptions: multipleChoiceAnswerOptions,
                                    paramInTotalWrongOptions: inTotalSelectedWrongOptions,
                                    paramInTotalRightOptions: inTotalSelectedRightOptions,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    wrongOption: wrongOption,
                                    rightOption: rightOption,
                                }"
                            ></p>
                            <b>+ {{ inTotalSelectedRightOptions }}*{{ question().points }} /{{ multipleChoiceAnswerOptions }} = {{ score() }}</b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                    @if (!(correctMultipleChoiceAnswers === multipleChoiceCorrectAnswerCorrectlyChosen && multipleChoiceWrongAnswerChosen === 0) && differenceMultipleChoice < 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.multipleChoiceProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramAmountOfAnswerOptions: multipleChoiceAnswerOptions,
                                    paramInTotalWrongOptions: inTotalSelectedWrongOptions,
                                    paramInTotalRightOptions: inTotalSelectedRightOptions,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    wrongOption: wrongOption,
                                    rightOption: rightOption,
                                }"
                            ></p>
                            <b>+ {{ inTotalSelectedRightOptions }}*{{ question().points }} /{{ multipleChoiceAnswerOptions }} = 0 </b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                </div>
            }
            @if (question().type === QuizQuestionType.DRAG_AND_DROP) {
                <div>
                    @if (incorrectlyMappedDragAndDropItems() === 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (incorrectlyMappedDragAndDropItems() !== 0 && differenceDragAndDrop >= 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramWrongMappedItems: incorrectlyMappedDragAndDropItems(),
                                    paramRightMapping: correctlyMappedDragAndDropItems(),
                                    paramDragAndDropElementsCount: mappedLocations(),
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightMap: rightMap,
                                    wrongMap: wrongMap,
                                }"
                            ></p>
                            <b>+ {{ correctlyMappedDragAndDropItems() }}*{{ question().points }}/{{ mappedLocations() }} = {{ score() }}</b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                    @if (incorrectlyMappedDragAndDropItems() !== 0 && differenceDragAndDrop < 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.dragAndDropProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramWrongMappedItems: incorrectlyMappedDragAndDropItems(),
                                    paramRightMapping: correctlyMappedDragAndDropItems(),
                                    paramDragAndDropElementsCount: mappedLocations(),
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightMap: rightMap,
                                    wrongMap: wrongMap,
                                }"
                            ></p>
                            <b>+ {{ correctlyMappedDragAndDropItems() }}*{{ question().points }}/{{ mappedLocations() }} = 0 </b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.zeroPointer"></p>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                </div>
            }
            @if (question().type === QuizQuestionType.SHORT_ANSWER) {
                <div>
                    @if (shortAnswerWrongAnswers <= 0) {
                        <span>
                            <span
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerAllOrNothingCorrect"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                }"
                            ></span
                        ></span>
                    }
                    @if (shortAnswerWrongAnswers > 0 && differenceShortAnswer >= 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramShortAnswerWrongOption: shortAnswerWrongAnswers,
                                    paramShortAnswerCorrectAnswers: shortAnswerCorrectAnswers,
                                    paramCount: shortAnswerSpots,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightGap: rightGap,
                                    wrongGap: wrongGap,
                                }"
                            ></p>
                            <b>+ {{ shortAnswerCorrectAnswers }}*{{ question().points }}/{{ shortAnswerSpots }} = {{ score() }}</b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                    @if (shortAnswerWrongAnswers > 0 && differenceShortAnswer < 0) {
                        <span>
                            <p
                                jhiTranslate="artemisApp.quizExercise.explanationText.shortAnswerProp"
                                [translateValues]="{
                                    paramScore: score(),
                                    paramQuestionScore: question().points,
                                    paramShortAnswerWrongOption: shortAnswerWrongAnswers,
                                    paramShortAnswerCorrectAnswers: shortAnswerCorrectAnswers,
                                    paramCount: shortAnswerSpots,
                                    paramPoint: scorePoint,
                                    paramScorePoint: questionPoint,
                                    rightGap: rightGap,
                                    wrongGap: wrongGap,
                                }"
                            ></p>
                            <b>+ {{ shortAnswerCorrectAnswers }}*{{ question().points }}/{{ shortAnswerSpots }} = 0 </b>
                            <p jhiTranslate="artemisApp.quizExercise.explanationText.KeepTrying"></p>
                        </span>
                    }
                </div>
            }
        </div>
    }
    <div class="modal-footer">
        <button type="button" class="btn btn-outline" (click)="c()">Close</button>
    </div>
</ng-template>
<div>
    <button class="btn" (click)="open(scoringExplanation)">
        <fa-icon [ngClass]="{ questionCorrect: score() === question().points, questionWrong: score() !== question().points }" [icon]="farQuestionCircle" />
    </button>
</div>
