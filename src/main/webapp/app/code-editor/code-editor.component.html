<div class="editor-wrapper">
    <jhi-alert></jhi-alert>
    <jhi-alert-error></jhi-alert-error>
    <div *jhiHasAnyAuthority="['ROLE_TA', 'ROLE_INSTRUCTOR']">Tutor, Instructor</div>
    <nav class="navbar navbar-light navbar-expand-sm jh-navbar">
        <div *jhiHasAnyAuthority="['ROLE_TA', 'ROLE_INSTRUCTOR']" ngbDropdown class="d-inline-block mr-2">
            <button class="btn btn-outline-primary" id="dropdownBasic1" ngbDropdownToggle>Toggle dropdown</button>
            <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
                <button
                    [disabled]="!exercise || !exercise.templateParticipation || !exercise.templateParticipation.id"
                    (click)="selectParticipation(exercise.templateParticipation.id)"
                    ngbDropdownItem
                    jhiTranslate="arTeMiSApp.editor.repoSelect.templateRepo"
                >
                    Template Repository
                </button>
                <button
                    [disabled]="!exercise || !exercise.solutionParticipation || !exercise.solutionParticipation.id"
                    (click)="selectParticipation(exercise.solutionParticipation.id)"
                    ngbDropdownItem
                    jhiTranslate="arTeMiSApp.editor.repoSelect.solutionRepo"
                >
                    Solution Repository
                </button>
                <button
                    [disabled]="!exercise || !exercise.assignmentParticipation"
                    (click)="selectAssignmentParticipation()"
                    ngbDropdownItem
                    jhiTranslate="arTeMiSApp.editor.repoSelect.assignmentRepo"
                >
                    Assignment Participation
                </button>
            </div>
            <div>
                <button (click)="createAssignmentParticipation()" [disabled]="exercise && exercise.assignmentParticipation" class="btn btn-primary">
                    <fa-icon icon="plus" class="text-danger"></fa-icon>Create assignment participation
                </button>
                <button [disabled]="exercise && !exercise.assignmentParticipation" class="btn btn-danger">
                    <fa-icon icon="times" class="text-danger"></fa-icon>Reset assignment participation
                </button>
            </div>
        </div>
        <div class="jh-logo-container float-left editor-top-left">
            <span class="navbar-title" jhiTranslate="arTeMiSApp.editor.title"> </span>
            <span>{{ participation?.exercise.title }}</span>
        </div>
        <div class="navbar-collapse editor-top-right">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown pointer">
                    <jhi-result [participation]="participation" [isBuilding]="isBuilding" (newResult)="updateLatestResult()" [hidden]="isBuilding"> </jhi-result>
                </li>
            </ul>
        </div>
        <jhi-code-editor-actions
            [editorState]="editorState"
            [commitState]="commitState"
            [isBuilding]="isBuilding"
            [onSave]="editor.saveChangedFiles.bind(editor)"
            [onCommit]="commit.bind(this)"
        ></jhi-code-editor-actions>
    </nav>

    <div class="editor-main">
        <div class="editor-sidebar-left">
            <jhi-code-editor-file-browser
                [participation]="participation"
                [fileName]="selectedFile"
                [repositoryFiles]="repositoryFiles"
                [unsavedFiles]="unsavedFiles"
                [errorFiles]="errorFiles"
                [editorState]="editorState"
                [commitState]="commitState"
                (selectedFile)="updateSelectedFile($event)"
                (createdFile)="updateRepositoryCommitStatus($event)"
                (deletedFile)="updateRepositoryCommitStatus($event)"
            >
            </jhi-code-editor-file-browser>
        </div>

        <div class="editor-center">
            <jhi-code-editor-ace
                [participation]="participation"
                [selectedFile]="selectedFile"
                [repositoryFiles]="repositoryFiles"
                [buildLogErrors]="buildLogErrors ? buildLogErrors.errors : {}"
                [editorState]="editorState"
                (onEditorStateChange)="setEditorState($event)"
                (onUnsavedFilesChange)="setUnsavedFiles($event)"
                (onError)="onError($event)"
            >
            </jhi-code-editor-ace>
        </div>

        <div class="editor-sidebar-right">
            <jhi-code-editor-instructions [participation]="participation"> </jhi-code-editor-instructions>
        </div>
    </div>

    <div class="editor-bottom">
        <jhi-code-editor-build-output [participation]="participation" [isBuilding]="isBuilding" (buildLogChange)="updateLatestBuildLogs($event)"> </jhi-code-editor-build-output>
    </div>
</div>
