api: v0.0.1
metadata:
  name: "Java Gradle Static"
  id: java_plain_gradle_static
  description: "Build configuration for Java Gradle exercises with static code analysis"
actions:
  - name: gradle
    script: |-
      chmod +x ./gradlew

      # Compile the code
      ./gradlew clean testClasses
      COMPILATION_EXIT_CODE=$?

      if [ $COMPILATION_EXIT_CODE -ne 0 ]; then
          exit 1
      fi

      # Run the tests
      ./gradlew test || true
    runAlways: false
  - name: static_code_analysis
    script: ./gradlew check -x test
    runAlways: true
    results:
      - name: spotbugs
        path: target/spotbugsXml.xml
        type: static-code-analysis
      - name: checkstyle
        path: target/checkstyle-result.xml
        type: static-code-analysis
      - name: pmd
        path: target/pmd.xml
        type: static-code-analysis
      - name: pmd_cpd
        path: target/cpd.xml
        type: static-code-analysis
      - name: junit_**/test-results/test/*.xml
        path: '**/test-results/test/*.xml'
        type: junit
