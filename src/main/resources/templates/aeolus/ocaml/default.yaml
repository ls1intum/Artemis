api: v0.0.1
metadata:
    name: ocaml-normal
    id: ocaml-normal
    description: Build Plan for OCaml Exercises
    docker:
        image: ghcr.io/ls1intum/artemis-ocaml-docker
        tag: latest
        volumes:
            - ${WORKDIR}:${WORKDIR}
            - ${TMPDIR}:${TMPDIR}
        parameters:
            - --cpus
            - '"2"'
            - --memory
            - '"2g"'
            - --memory-swap
            - '"2g"'
            - --pids-limit
            - '"1000"'
actions:
    - name: build_and_test_the_code
      script: |-
          # the build process is specified in `run.sh` in the test repository
          cd tests
          chmod +x run.sh
          cat run.sh
          ./run.sh -s
      runAlways: false
    - name: junit
      parameters:
          ignore_time: false
          test_results: '**/test-reports/*.xml'
      platform: bamboo
      kind: junit
      runAlways: true
