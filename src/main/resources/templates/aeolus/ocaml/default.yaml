api: v0.0.1
metadata:
  name: "OCaml"
  id: ocaml
  description: "Default build configuration for OCaml exercises"
actions:
  - name: build_and_test_the_code
    script: |-
      # the build process is specified in `run.sh` in the test repository
      chmod +x run.sh

      # Run the build and tests
      # run.sh exits with 1 on compilation failure, 0 otherwise
      ./run.sh -s
      COMPILATION_EXIT_CODE=$?

      if [ $COMPILATION_EXIT_CODE -ne 0 ]; then
          exit 1
      fi
    workdir: ${testWorkingDirectory}
    runAlways: false
  - name: junit
    script: '#empty script action, just for the results'
    runAlways: true
    results:
      - name: junit
        path: 'test-reports/*.xml'
        type: junit
        before: true
