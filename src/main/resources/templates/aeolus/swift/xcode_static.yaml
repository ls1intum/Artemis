api: v0.0.1
metadata:
    name: swiftxcodestatic
    id: swiftxcodestatic
    description:  Build Plan for Swift Exercises with Xcode and Static Code Analysis
actions:
    - name: build_the_code
      script: |
          export LC_ALL=en_US.UTF-8
          export LANG=en_US.UTF-8

          # Build the project
          fastlane build
      runAlways: false
    - name: test_the_code
      script: |
          export LC_ALL=en_US.UTF-8
          export LANG=en_US.UTF-8

          # Test the code and write test results into junit file
          fastlane test
          exit 0
      runAlways: false
    - name: junit
      parameters:
          ignore_time: false
          test_results: '**/report.junit'
      platform: bamboo
      kind: junit
      runAlways: true
    - name: run_static_code_analysis
      script: |
          export LC_ALL=en_US.UTF-8
          export LANG=en_US.UTF-8

          # Create directory for the swiftlint output specified in the fastfile
          mkdir target
          # Execute static code analysis
          fastlane sca
      runAlways: true
