api: v0.0.1
metadata:
  name: JavaScript
  id: javascript
  description: Run tests using Jest
actions:
  - name: install_dependencies
    script: 'npm ci --prefer-offline --no-audit'
  - name: syntax_check
    script: |-
      # Check for syntax errors in the student code
      find "${studentParentWorkingDirectoryName}" -name "*.js" -not -path "*/node_modules/*" -exec node --check {} +
      COMPILATION_EXIT_CODE=$?

      if [ $COMPILATION_EXIT_CODE -ne 0 ]; then
          exit 1
      fi
  - name: test
    script: |-
      # Run the tests
      npm run test:ci || true
    runAlways: false
    results:
      - name: junit
        path: 'junit.xml'
        type: junit
